<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ElasticSearch | 冷冷</title><meta name="keywords" content="学习"><meta name="author" content="Leng Leng"><meta name="copyright" content="Leng Leng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Elasticsearch使用指南 Elasticsearch使用指南 前言 ES是什么 什么是全文检索 ES的应用场景 ES的存储结构   第一章：安装 1.下载 2.解压 3.配置 4.启动 5.查看内存 7.内存优化 6.访问网页 7.可视化插件   第二章：查询 1.多索引 2.多类型 3.URI搜索 4.请求正文搜索   第三章：搜索 1.短语匹配 2.提高精度 3.组合查询 4.提高权">
<meta property="og:type" content="article">
<meta property="og:title" content="ElasticSearch">
<meta property="og:url" content="https://www.520517.xyz/2021/03/25/d48132d3.html">
<meta property="og:site_name" content="冷冷">
<meta property="og:description" content="Elasticsearch使用指南 Elasticsearch使用指南 前言 ES是什么 什么是全文检索 ES的应用场景 ES的存储结构   第一章：安装 1.下载 2.解压 3.配置 4.启动 5.查看内存 7.内存优化 6.访问网页 7.可视化插件   第二章：查询 1.多索引 2.多类型 3.URI搜索 4.请求正文搜索   第三章：搜索 1.短语匹配 2.提高精度 3.组合查询 4.提高权">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://api.mtyqx.cn/api/random.php?44">
<meta property="article:published_time" content="2021-03-25T12:02:36.000Z">
<meta property="article:modified_time" content="2021-10-30T00:54:29.419Z">
<meta property="article:author" content="Leng Leng">
<meta property="article:tag" content="学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://api.mtyqx.cn/api/random.php?44"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.520517.xyz/2021/03/25/d48132d3"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/my-zhb/CDN/blog/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Leng Leng","link":"链接: ","source":"来源: 冷冷","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: {"text":"富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善","fontSize":"10px"},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: true
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-10-30 08:54:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><script defer src="https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"></script><script>window.FPConfig={delay:0.5,ignoreKeywords:[],maxRPS:3,hoverDelay:50};</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="冷冷" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="https://cdn.jsdelivr.net/gh/myGitxb/picpigo/img/20201205124619.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">90</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-bookmark"></i><span> 文章</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(http://api.mtyqx.cn/api/random.php?44)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">冷冷</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-bookmark"></i><span> 文章</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">ElasticSearch</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label"></span><time datetime="2021-03-25T12:02:36.000Z" title="undefined 2021-03-25 20:02:36">2021-03-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Elasticsearch使用指南"><a href="#Elasticsearch使用指南" class="headerlink" title="Elasticsearch使用指南"></a>Elasticsearch使用指南</h1><ul>
<li>Elasticsearch使用指南<ul>
<li>前言<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#es%E6%98%AF%E4%BB%80%E4%B9%88">ES是什么</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#%E4%BB%80%E4%B9%88%E6%98%AF%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2">什么是全文检索</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#es%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">ES的应用场景</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#es%E7%9A%84%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84">ES的存储结构</a></li>
</ul>
</li>
<li>第一章：安装<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#1%E4%B8%8B%E8%BD%BD">1.下载</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#2%E8%A7%A3%E5%8E%8B">2.解压</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#3%E9%85%8D%E7%BD%AE">3.配置</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#4%E5%90%AF%E5%8A%A8">4.启动</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#5%E6%9F%A5%E7%9C%8B%E5%86%85%E5%AD%98">5.查看内存</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#7%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96">7.内存优化</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#6%E8%AE%BF%E9%97%AE%E7%BD%91%E9%A1%B5">6.访问网页</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#7%E5%8F%AF%E8%A7%86%E5%8C%96%E6%8F%92%E4%BB%B6">7.可视化插件</a></li>
</ul>
</li>
<li>第二章：查询<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#1%E5%A4%9A%E7%B4%A2%E5%BC%95">1.多索引</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#2%E5%A4%9A%E7%B1%BB%E5%9E%8B">2.多类型</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#3uri%E6%90%9C%E7%B4%A2">3.URI搜索</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#4%E8%AF%B7%E6%B1%82%E6%AD%A3%E6%96%87%E6%90%9C%E7%B4%A2">4.请求正文搜索</a></li>
</ul>
</li>
<li>第三章：搜索<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#1%E7%9F%AD%E8%AF%AD%E5%8C%B9%E9%85%8D">1.短语匹配</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#2%E6%8F%90%E9%AB%98%E7%B2%BE%E5%BA%A6">2.提高精度</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#3%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2">3.组合查询</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#4%E6%8F%90%E9%AB%98%E6%9D%83%E9%87%8D">4.提高权重</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#5%E5%88%86%E9%A1%B5">5.分页</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#6%E6%8C%87%E5%AE%9A%E8%BF%94%E5%9B%9E%E5%B1%9E%E6%80%A7">6.指定返回属性</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#7%E9%AB%98%E4%BA%AE%E6%90%9C%E7%B4%A2">7.高亮搜索</a></li>
</ul>
</li>
<li>第四章：SpringBoot<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#1springdata">1.SpringData</a></li>
</ul>
</li>
<li>spring data elasticsearch elasticsearch 3.1.x 6.2.2 3.0.x 5.5.0 2.1.x 2.4.0 2.0.x 2.2.0 1.3.x 1.5.2<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#2%E4%BE%9D%E8%B5%96%E5%86%B2%E7%AA%81">2.依赖冲突</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#2%E5%85%A5%E9%97%A8">2.入门</a></li>
</ul>
</li>
<li>第五章：JEST<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#1%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96">1.导入依赖</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#2%E9%85%8D%E7%BD%AE">2.配置</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#3%E5%AE%9E%E4%BD%93%E7%B1%BB">3.实体类</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#4%E4%BF%9D%E5%AD%98">4.保存</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#5%E6%9F%A5%E8%AF%A2">5.查询</a></li>
</ul>
</li>
<li>第六章：Repository<ul>
<li>1.查询<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#%E5%85%B3%E9%94%AE%E5%AD%97">关键字</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#2%E4%BF%9D%E5%AD%98">2.保存</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#3%E6%9B%B4%E6%96%B0">3.更新</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#4%E5%88%A0%E9%99%A4">4.删除</a></li>
</ul>
</li>
<li>第七章：模板<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#1%E5%A2%9E%E5%8A%A0">1.增加</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#2%E5%88%A0%E9%99%A4">2.删除</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#3%E6%9B%B4%E6%96%B0-1">3.更新</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#4%E6%9F%A5%E8%AF%A2">4.查询</a></li>
</ul>
</li>
<li>第八章：术语<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#analysis%E5%88%86%E6%9E%90">Analysis（分析）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#cluster-%E9%9B%86%E7%BE%A4">Cluster （集群）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#document%E6%96%87%E6%A1%A3">Document（文档）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#id%E6%A0%87%E8%AF%86">Id（标识）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#field%E5%AD%97%E6%AE%B5">Field（字段）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#index%E7%B4%A2%E5%BC%95">Index（索引）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#mapping%E6%98%A0%E5%B0%84">Mapping（映射）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#node%E8%8A%82%E7%82%B9">Node（节点）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#primary-shard%E4%B8%BB%E5%88%86%E7%89%87">Primary shard（主分片）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#replica-shard%E5%89%AF%E6%9C%AC%E5%88%86%E7%89%87">Replica shard（副本分片）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#routing%E8%B7%AF%E7%94%B1">Routing（路由）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#shard%E5%88%86%E7%89%87">Shard（分片）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#source-field%E6%BA%90%E5%AD%97%E6%AE%B5">Source field（源字段）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#term%E6%9C%AF%E8%AF%AD">Term（术语）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#text%E6%96%87%E6%9C%AC">Text(文本)</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#type%E7%B1%BB%E5%9E%8B">Type(类型)</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#%E7%AC%AC%E4%B9%9D%E7%AB%A0%E6%9E%84%E5%BB%BA%E6%9F%A5%E8%AF%A2">第九章：构建查询</a></li>
<li>第十章：条件查询<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#1%E5%AE%8C%E5%85%A8%E5%8C%B9%E9%85%8D">1.完全匹配</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#2%E7%9F%AD%E8%AF%AD%E5%8C%B9%E9%85%8D">2.短语匹配</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#3%E6%A8%A1%E7%B3%8A%E5%8C%B9%E9%85%8D">3.模糊匹配</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#4%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2">4.组合查询</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#5%E5%8C%85%E8%A3%B9%E6%9F%A5%E8%AF%A2">5.包裹查询</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#6%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2">6.范围查询</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#7%E9%80%9A%E9%85%8D%E7%AC%A6%E6%9F%A5%E8%AF%A2">7.通配符查询</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/WGH100817/article/details/101721154?ops_request_misc=%7B%22request_id%22:%22161667354516780269887542%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=161667354516780269887542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-5-101721154.pc_search_result_cache&utm_term=elasticserarch%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B#8%E8%BF%87%E6%BB%A4%E6%9F%A5%E8%AF%A2">8.过滤查询</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><em>Create by <a href="mailto:&#x79;&#115;&#116;&#x65;&#114;&#64;&#x66;&#x6f;&#120;&#109;&#x61;&#105;&#x6c;&#x2e;&#99;&#x6f;&#109;">&#x79;&#115;&#116;&#x65;&#114;&#64;&#x66;&#x6f;&#120;&#109;&#x61;&#105;&#x6c;&#x2e;&#99;&#x6f;&#109;</a> 2018-7-1</em></li>
<li>官方文档：<a target="_blank" rel="noopener" href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html">https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html</a></li>
<li>23个很有用的查询示例：<a target="_blank" rel="noopener" href="https://www.coyee.com/article/10764-23-useful-elasticsearch-example-queries/">https://www.coyee.com/article/10764-23-useful-elasticsearch-example-queries/</a></li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h3 id="ES是什么"><a href="#ES是什么" class="headerlink" title="ES是什么"></a>ES是什么</h3><p>ElasticSearch简写ES，ES是一个高扩展、开源的全文检索和分析引擎，它可以准实时地快速存储、搜索、分析海量的数据。</p>
<h3 id="什么是全文检索"><a href="#什么是全文检索" class="headerlink" title="什么是全文检索"></a>什么是全文检索</h3><p>全文检索是指计算机索引程序通过扫描文章中的每一个词，对每一个词建立一个索引，指明该词在文章中出现的次数和位置，当用户查询时，检索程序就根据事先建立的索引进行查找，并将查找的结果反馈给用户的检索方式。这个过程类似于通过字典中的检索字表查字的过程。全文搜索搜索引擎数据库中的数据。</p>
<h3 id="ES的应用场景"><a href="#ES的应用场景" class="headerlink" title="ES的应用场景"></a>ES的应用场景</h3><ul>
<li>一个线上商城系统，用户需要搜索商城上的商品。<br>在这里你可以用ES存储所有的商品信息和库存信息，用户只需要输入”空调”就可以搜索到他需要搜索到的商品。</li>
<li>一个运行的系统需要收集日志，用这些日志来分析、挖掘从而获取系统业务未来的趋势。<br>你可以用logstash（elk中的一个产品，elasticsearch/logstash/kibana）收集、转换你的日志，并将他们存储到ES中。一旦数据到达ES中，就你可以在里面搜索、运行聚合函数等操作来挖掘任何你感兴趣的信息。</li>
<li>如果你有想基于大量数据（数百万甚至数十亿的数据）快速调查、分析并且要将分析结果可视化的需求。<br>你可以用ES来存储你的数据，用kibana构建自定义的可视化图形、报表，为业务决策提供科学的数据依据。</li>
</ul>
<p>直白点讲，ES是一个企业级海量数据的搜索引擎，可以理解为是一个企业级的百度搜索，除了搜索之外，ES还可以快速的实现聚合运算。</p>
<h3 id="ES的存储结构"><a href="#ES的存储结构" class="headerlink" title="ES的存储结构"></a>ES的存储结构</h3><p><img src= "/img/loading.gif" data-lazy-src="https://img-blog.csdn.net/2018070800464767?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1ZXNodXRvbmcxMjM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p>ES存储结构与MYSQL具有如下对应关系：</p>
<table>
<thead>
<tr>
<th>ES</th>
<th>MYSQL</th>
</tr>
</thead>
<tbody><tr>
<td>索引</td>
<td>数据库</td>
</tr>
<tr>
<td>类型</td>
<td>数据表</td>
</tr>
<tr>
<td>文档</td>
<td>数据表的一行</td>
</tr>
<tr>
<td>属性</td>
<td>数据表的一列</td>
</tr>
</tbody></table>
<h2 id="第一章：安装"><a href="#第一章：安装" class="headerlink" title="第一章：安装"></a>第一章：安装</h2><p>环境：</p>
<p>Centos7.4系统</p>
<p>Putty远程连接</p>
<h3 id="1-下载"><a href="#1-下载" class="headerlink" title="1.下载"></a>1.下载</h3><p>下载地址去官网啥的复制下来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;download.elastic.co&#x2F;elasticsearch&#x2F;release&#x2F;org&#x2F;elasticsearch&#x2F;distribution&#x2F;tar&#x2F;elasticsearch&#x2F;2.4.1&#x2F;elasticsearch-2.4.1.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="2-解压"><a href="#2-解压" class="headerlink" title="2.解压"></a>2.解压</h3><p>新手注意下执行目录不要错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf elasticsearch-2.4.1.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="3-配置"><a href="#3-配置" class="headerlink" title="3.配置"></a>3.配置</h3><p>找到解压后的config文件夹打开elasticsearch.yml</p>
<p>下面贴出我的设置</p>
<p>关键是要打开<code>network.host: 0.0.0.0</code>和<code>http.port: 9200</code>注释，提供web访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br></pre></td><td class="code"><pre><span class="line"># &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Elasticsearch Configuration &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># NOTE: Elasticsearch comes with reasonable defaults for most settings.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#       Before you set out to tweak and tune the configuration, make sure you</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#       understand what are you trying to accomplish and the consequences.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># The primary way of configuring a node is via this file. This template lists</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># the most important settings you may want to configure for a production cluster.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Please see the documentation for further information on configuration options:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># &lt;http:&#x2F;&#x2F;www.elastic.co&#x2F;guide&#x2F;en&#x2F;elasticsearch&#x2F;reference&#x2F;current&#x2F;setup-configuration.html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------------------- Cluster -----------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Use a descriptive name for your cluster:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 集群名称，默认为elasticsearch</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cluster.name: my-application</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ------------------------------------ Node ------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Use a descriptive name for the node:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 节点名称，es启动时会自动创建节点名称，但你也可进行配置</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">node.name: node-1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Add custom attributes to the node:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 是否作为主节点，每个节点都可以被配置成为主节点，默认值为true：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># node.master: true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># node.rack: r1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ----------------------------------- Paths ------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Path to directory where to store the data (separate multiple locations by comma):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 分配给当前节点的索引数据所在的位置</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># path.data: &#x2F;path&#x2F;to&#x2F;data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Path to log files:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 日志文件所在位置</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># path.logs: &#x2F;path&#x2F;to&#x2F;logs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ----------------------------------- Memory -----------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Lock the memory on startup:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># bootstrap.memory_lock: true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Make sure that the &#96;ES_HEAP_SIZE&#96; environment variable is set to about half the memory</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># available on the system and that the owner of the process is allowed to use this limit.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Elasticsearch performs poorly when the system is swapping the memory.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------------------- Network -----------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Set the bind address to a specific IP (IPv4 or IPv6):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">network.host: 0.0.0.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Set a custom port for HTTP:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http.port: 9200</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># For more information, see the documentation at:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># &lt;http:&#x2F;&#x2F;www.elastic.co&#x2F;guide&#x2F;en&#x2F;elasticsearch&#x2F;reference&#x2F;current&#x2F;modules-network.html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># --------------------------------- Discovery ----------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Pass an initial list of hosts to perform discovery when new node is started:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># The default list of hosts is [&quot;127.0.0.1&quot;, &quot;[::1]&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># discovery.zen.ping.unicast.hosts: [&quot;host1&quot;, &quot;host2&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Prevent the &quot;split brain&quot; by configuring the majority of nodes (total number of nodes &#x2F; 2 + 1):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># discovery.zen.minimum_master_nodes: 3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># For more information, see the documentation at:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># &lt;http:&#x2F;&#x2F;www.elastic.co&#x2F;guide&#x2F;en&#x2F;elasticsearch&#x2F;reference&#x2F;current&#x2F;modules-discovery.html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------------------- Gateway -----------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Block initial recovery after a full cluster restart until N nodes are started:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># gateway.recover_after_nodes: 3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># For more information, see the documentation at:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># &lt;http:&#x2F;&#x2F;www.elastic.co&#x2F;guide&#x2F;en&#x2F;elasticsearch&#x2F;reference&#x2F;current&#x2F;modules-gateway.html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ---------------------------------- Various -----------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Disable starting multiple nodes on a single system:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># node.max_local_storage_nodes: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Require explicit names when deleting indices:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># action.destructive_requires_name: true</span><br></pre></td></tr></table></figure>

<h3 id="4-启动"><a href="#4-启动" class="headerlink" title="4.启动"></a>4.启动</h3><p>在bin目录下执行命令</p>
<p>1.规范的方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;elasticsearch -d</span><br></pre></td></tr></table></figure>

<p>2.通用的方式（注意&amp;的语法是为了让程序后台执行，当你<code>Ctrl</code>+<code>C</code>退出时程序依旧运行）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;elasticsearch &amp;</span><br></pre></td></tr></table></figure>

<p>这里应该会报错，提示不能使用root用户启动该服务。</p>
<p>然后你可以新建一个用户admin，并设置elasticsearch解压后的所有文件权限为777，命令行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">useradd admin</span><br><span class="line">chmod -R 777 elasticsearch</span><br><span class="line">su admin</span><br><span class="line">.&#x2F;elasticsearch -d</span><br></pre></td></tr></table></figure>

<h3 id="5-查看内存"><a href="#5-查看内存" class="headerlink" title="5.查看内存"></a>5.查看内存</h3><p>执行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef|grep elasticsearch</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://img-blog.csdn.net/20180708004719332?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1ZXNodXRvbmcxMjM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p>可以看到在内存为2G的主机上，Elasticsearch的运行内存为 <code>-Xms256m -Xmx1g</code></p>
<h3 id="7-内存优化"><a href="#7-内存优化" class="headerlink" title="7.内存优化"></a>7.内存优化</h3><p>1.最简单的一个方法就是指定ES_HEAP_SIZE环境变量。服务进程在启动时候会读取这个变量，并相应的设置堆的大小。设置命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export ES_HEAP_SIZE&#x3D;1g</span><br></pre></td></tr></table></figure>

<p>2.我们可以在启动程序时限制内存大小，不过这个方法并不是每个情况都可以成功的，命令行如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;elasticsearch -Xms256m -Xmx256m -d</span><br></pre></td></tr></table></figure>

<p><em>备注:</em> 确保Xmx和Xms的大小是相同的，其目的是为了能够在java垃圾回收机制清理完堆区后不需要重新分隔计算堆区的大小而浪费资源，可以减轻伸缩堆大小带来的压力。 一般来说设置ES_HEAP_SIZE环境变量，比直接写-Xmx10g -Xms10g更好一点。</p>
<h3 id="6-访问网页"><a href="#6-访问网页" class="headerlink" title="6.访问网页"></a>6.访问网页</h3><p>因为开启了http访问，并设置可以远程连接，所以我们直接请求网址即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;你的服务器IP:9200</span><br></pre></td></tr></table></figure>

<p>网页响应内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;name&quot;: &quot;node-1&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;cluster_name&quot;: &quot;my-application&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;cluster_uuid&quot;: &quot;zrghL-WiQzeVE4rlX0WUAg&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;version&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;number&quot;: &quot;2.4.1&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;build_hash&quot;: &quot;c67dc32e24162035d18d6fe1e952c4cbcbe79d16&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;build_timestamp&quot;: &quot;2016-09-27T18:57:55Z&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;build_snapshot&quot;: false,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;lucene_version&quot;: &quot;5.5.2&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;tagline&quot;: &quot;You Know, for Search&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>安装成功！</p>
<h3 id="7-可视化插件"><a href="#7-可视化插件" class="headerlink" title="7.可视化插件"></a>7.可视化插件</h3><p>利用在bin目录下提供的plugin插件安装head，实现web可视化</p>
<p>注意目录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;bin&#x2F;plugin install mobz&#x2F;elasticsearch-head</span><br></pre></td></tr></table></figure>

<p>安装完后访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;你的服务器IP:9200&#x2F;_plugin&#x2F;head&#x2F;</span><br></pre></td></tr></table></figure>

<p>出现</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://img-blog.csdn.net/20180708004736913?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1ZXNodXRvbmcxMjM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<h2 id="第二章：查询"><a href="#第二章：查询" class="headerlink" title="第二章：查询"></a>第二章：查询</h2><h3 id="1-多索引"><a href="#1-多索引" class="headerlink" title="1.多索引"></a>1.多索引</h3><p>Elasticsearch允许我们搜索存在于所有索引或一些特定索引中的文档。 例如，如果我们需要搜索名称包含<code>central</code>的所有文档。<strong>注意此时的URL无索引</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http:&#x2F;&#x2F;localhost:9200&#x2F;_search?q &#x3D; name:central</span><br></pre></td></tr></table></figure>

<p><strong>响应</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;took&quot;: 78,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;timed_out&quot;: false,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;_shards&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;total&quot;: 10,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;successful&quot;: 10,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;failed&quot;: 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;hits&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;total&quot;: 1,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;max_score&quot;: 0.19178301,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;hits&quot;: [</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;_index&quot;: &quot;schools&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;_type&quot;: &quot;school&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;_id&quot;: &quot;1&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;_score&quot;: 0.19178301,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;_source&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;name&quot;: &quot;Central School&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;description&quot;: &quot;CBSE Affiliation&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;street&quot;: &quot;Nagan&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;city&quot;: &quot;paprola&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;state&quot;: &quot;HP&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;zip&quot;: &quot;176115&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;location&quot;: [</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        31.8955385,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        76.8380405</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    ],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;fees&quot;: 2000,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;tags&quot;: [</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        &quot;Senior Secondary&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        &quot;beautiful campus&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    ],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;rating&quot;: &quot;3.5&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者，同样地我们可以在<code>schools</code>，<code>schools_gov</code>索引中搜索 -</p>
<h3 id="2-多类型"><a href="#2-多类型" class="headerlink" title="2.多类型"></a>2.多类型</h3><p>还可以在所有类型或某种指定类型的索引中搜索所有文档。 例如，<strong>注意此时的URL无类型</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get http:&#x2F;&#x2F;localhost:9200&#x2F;schools&#x2F;_search?q &#x3D; tags:sports</span><br></pre></td></tr></table></figure>

<p><strong>响应</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;took&quot;: 16,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;timed_out&quot;: false,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;_shards&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;total&quot;: 5,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;successful&quot;: 5,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;failed&quot;: 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;hits&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;total&quot;: 1,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;max_score&quot;: 0.5,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;hits&quot;: [</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;_index&quot;: &quot;schools&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;_type&quot;: &quot;school&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;_id&quot;: &quot;2&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;_score&quot;: 0.5,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;_source&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;name&quot;: &quot;Saint Paul School&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;description&quot;: &quot;ICSE Afiliation&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;street&quot;: &quot;Dawarka&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;city&quot;: &quot;Delhi&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;state&quot;: &quot;Delhi&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;zip&quot;: &quot;110075&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;location&quot;: [</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        28.5733056,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        77.0122136</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    ],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;fees&quot;: 5000,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;tags&quot;: [</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        &quot;Good Faculty&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        &quot;Great Sports&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    ],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;rating&quot;: &quot;4.5&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-URI搜索"><a href="#3-URI搜索" class="headerlink" title="3.URI搜索"></a>3.URI搜索</h3><p>如下这些参数可以使用统一资源标识符在搜索操作中传递 -</p>
<table>
<thead>
<tr>
<th align="left">编号</th>
<th align="left">参数</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">Q</td>
<td align="left">此参数用于指定查询字符串。</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">lenient</td>
<td align="left">基于格式的错误可以通过将此参数设置为<code>true</code>来忽略。默认情况下为<code>false</code>。</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">fields</td>
<td align="left">此参数用于在响应中选择返回字段。</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">sort</td>
<td align="left">可以通过使用这个参数获得排序结果，这个参数的可能值是<code>fieldName</code>，<code>fieldName:asc</code>和<code>fieldname:desc</code></td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">timeout</td>
<td align="left">使用此参数限定搜索时间，响应只包含指定时间内的匹配。默认情况下，无超时。</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">terminate_after</td>
<td align="left">可以将响应限制为每个分片的指定数量的文档，当到达这个数量以后，查询将提前终止。 默认情况下不设置<code>terminate_after</code>。</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left"></td>
<td align="left">从命中的索引开始返回。默认值为<code>0</code>。</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left">size</td>
<td align="left">它表示要返回的命中数。默认值为<code>10</code>。</td>
</tr>
</tbody></table>
<h3 id="4-请求正文搜索"><a href="#4-请求正文搜索" class="headerlink" title="4.请求正文搜索"></a>4.请求正文搜索</h3><p>还可以在请求正文中使用查询<code>DSL</code>来指定查询，并且在前面的章节中已经给出了很多示例，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http:&#x2F;&#x2F;localhost:9200&#x2F;schools&#x2F;_search</span><br></pre></td></tr></table></figure>

<p><strong>请求正文</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &quot;query&quot;:&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &quot;query_string&quot;:&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">         &quot;query&quot;:&quot;up&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">JSON</span><br></pre></td></tr></table></figure>

<p><strong>响应</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">……………………………………………….</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &quot;_source&quot;:&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &quot;name&quot;:&quot;City School&quot;, &quot;description&quot;:&quot;ICSE&quot;, &quot;street&quot;:&quot;West End&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &quot;city&quot;:&quot;Meerut&quot;, &quot;state&quot;:&quot;UP&quot;, &quot;zip&quot;:&quot;250002&quot;, &quot;location&quot;:[28.9926174, 77.692485],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &quot;fees&quot;:3500, &quot;tags&quot;:[&quot;Well equipped labs&quot;],&quot;rating&quot;:&quot;4.5&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">……………………………………………….</span><br></pre></td></tr></table></figure>

<h2 id="第三章：搜索"><a href="#第三章：搜索" class="headerlink" title="第三章：搜索"></a>第三章：搜索</h2><h3 id="1-短语匹配"><a href="#1-短语匹配" class="headerlink" title="1.短语匹配"></a>1.短语匹配</h3><p>短语匹配用来解决准确匹配问题，例如匹配“头痛”不会出现“头晕”等近似词。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;my_index&#x2F;my_type&#x2F;_search</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;match_phrase&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &quot;title&quot;: &quot;quick brown fox&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&quot;match&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;title&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;query&quot;: &quot;quick brown fox&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;type&quot;:  &quot;phrase&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-提高精度"><a href="#2-提高精度" class="headerlink" title="2.提高精度"></a>2.提高精度</h3><p>使用<code>&quot;operator&quot;: &quot;and&quot;</code>提高精度或者 <code>&quot;minimum_should_match&quot;: &quot;90%&quot;</code> 控制精度</p>
<p><code>symptom</code>：属性，<code>query</code>：查询词语</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;match&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &quot;symptom&quot;: &#123;   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;query&quot;:    &quot;Love You&quot;,  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &#x2F;&#x2F;&quot;operator&quot;: &quot;and&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                 &quot;minimum_should_match&quot;: &quot;90%&quot; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-组合查询"><a href="#3-组合查询" class="headerlink" title="3.组合查询"></a>3.组合查询</h3><p>使用<strong>组合查询</strong>短语匹配含有symptom属性为“头痛”，“恶心”这两个词语的文档。<code>match_phrase</code>短语匹配</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;bool&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &quot;must&quot;: &#123; &quot;match_phrase&quot;: &#123; &quot;symptom&quot;: &quot;头痛&quot; &#125;&#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &quot;must&quot;: &#123; &quot;match_phrase&quot;: &#123; &quot;symptom&quot;: &quot;恶心&quot; &#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-提高权重"><a href="#4-提高权重" class="headerlink" title="4.提高权重"></a>4.提高权重</h3><p><code>boost</code> 参数被用来提升一个语句的相对权重（ <code>boost</code> 值大于 <code>1</code> ）或降低相对权重（ <code>boost</code>值处于 <code>0</code> 到 <code>1</code> 之间），但是这种提升或降低并不是线性的，换句话说，如果一个 <code>boost</code> 值为 <code>2</code> ，并不能获得两倍的评分 <code>_score</code> 。</p>
<p>相反，新的评分 <code>_score</code> 会在应用权重提升之后被 <em>归一化</em> ，每种类型的查询都有自己的归一算法，细节超出了本书的范围，所以不作介绍。简单的说，更高的 <code>boost</code> 值为我们带来更高的评分 <code>_score</code> 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;bool&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &quot;should&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;match&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;symptom&quot;: &#123; &quot;query&quot;: &quot;头痛&quot;, &quot;type&quot;: &quot;phrase&quot;, &quot;boost&quot;: 3 &#125; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">           &quot;should&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;match&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;symptom&quot;: &#123; &quot;query&quot;: &quot;恶心&quot;, &quot;type&quot;: &quot;phrase&quot;, &quot;boost&quot;: 2 &#125; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-分页"><a href="#5-分页" class="headerlink" title="5.分页"></a>5.分页</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">size</span><br></pre></td></tr></table></figure>

<p>显示应该返回的结果数量，默认是 <code>10</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from</span><br></pre></td></tr></table></figure>

<p>显示应该跳过的初始结果数量，默认是 <code>0</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">如果每页展示 5 条结果，可以用下面方式请求得到 1 到 3 页的结果：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GET &#x2F;_search?size&#x3D;5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GET &#x2F;_search?size&#x3D;5&amp;from&#x3D;5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GET &#x2F;_search?size&#x3D;5&amp;from&#x3D;10</span><br></pre></td></tr></table></figure>

<h3 id="6-指定返回属性"><a href="#6-指定返回属性" class="headerlink" title="6.指定返回属性"></a>6.指定返回属性</h3><p>只返回查询文档的name和sysptom属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;_source&quot;: [</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;name&quot;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;symptom&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-高亮搜索"><a href="#7-高亮搜索" class="headerlink" title="7.高亮搜索"></a>7.高亮搜索</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;bool&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &quot;must&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &quot;match&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &quot;symptom&quot;: &#123; &quot;query&quot;: &quot;恶心&quot;, &quot;minimum_should_match&quot;: &quot;100%&quot; &#125; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &quot;highlight&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;fields&quot;: &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &quot;symptom&quot;: &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第四章：SpringBoot"><a href="#第四章：SpringBoot" class="headerlink" title="第四章：SpringBoot"></a>第四章：SpringBoot</h2><p>Spring Boot默认支持两种技术来和ES交互，一种是Spring Data，一种是JEST（默认不生效）</p>
<h3 id="1-SpringData"><a href="#1-SpringData" class="headerlink" title="1.SpringData"></a>1.SpringData</h3><p>环境：IDEA+Spring Boot 1.5.13</p>
<p>首先明确elasticsearch的版本变化非常大，所以spring-boot-data-elasticsearch也针对不同版本写了不同的集成，具体的版本适配可以参考官方示例<a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-data-elasticsearch%EF%BC%8C%E5%BC%95%E7%94%A8%E5%AE%98%E6%96%B9%E7%A4%BA%E4%BE%8B%E5%A6%82%E4%B8%8B%EF%BC%9A">https://github.com/spring-projects/spring-data-elasticsearch，引用官方示例如下：</a></p>
<p>Add the Maven dependency:（增加Maven的依赖）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;org.springframework.data&lt;&#x2F;groupId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;artifactId&gt;spring-data-elasticsearch&lt;&#x2F;artifactId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;version&gt;x.y.z.RELEASE&lt;&#x2F;version&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<p>If you’d rather like the latest snapshots of the upcoming major version, use our Maven snapshot repository and declare the appropriate dependency version.（如果您希望获得即将发布的主要版本的最新快照，请使用我们的Maven快照存储库并声明适当的依赖版本。）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;groupId&gt;org.springframework.data&lt;&#x2F;groupId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;artifactId&gt;spring-data-elasticsearch&lt;&#x2F;artifactId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;version&gt;x.y.z.BUILD-SNAPSHOT&lt;&#x2F;version&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;repository&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;id&gt;spring-libs-snapshot&lt;&#x2F;id&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;name&gt;Spring Snapshot Repository&lt;&#x2F;name&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;url&gt;http:&#x2F;&#x2F;repo.spring.io&#x2F;libs-snapshot&lt;&#x2F;url&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;repository&gt;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">spring data elasticsearch</th>
<th align="left">elasticsearch</th>
</tr>
</thead>
<tbody><tr>
<td align="left">3.1.x</td>
<td align="left">6.2.2</td>
</tr>
<tr>
<td align="left">3.0.x</td>
<td align="left">5.5.0</td>
</tr>
<tr>
<td align="left">2.1.x</td>
<td align="left">2.4.0</td>
</tr>
<tr>
<td align="left">2.0.x</td>
<td align="left">2.2.0</td>
</tr>
<tr>
<td align="left">1.3.x</td>
<td align="left">1.5.2</td>
</tr>
</tbody></table>
<p>比如我的Spring Boot项目为<code>1.5.13.RELEASE</code>，在IDEA左侧可以查看到elasticsearch的版本</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://img-blog.csdn.net/20180708004814225?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1ZXNodXRvbmcxMjM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p>那我可以找到最接近的<code>2.1.x</code>对应的elasticsearch版本为2.4，我们这个项目使用的是2.4.1完全ok没问题。</p>
<p>那我们在application.yml配置一下服务器的elasticsearch地址：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  data:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    elasticsearch:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      cluster-name: my-application</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      cluster-nodes: 服务器Ip:9300</span><br></pre></td></tr></table></figure>

<p>cluster-name可以在访问9200端口时查看到。</p>
<p>然后我们启动项目测试一下，出现如图所示，-测试没问题。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://img-blog.csdn.net/20180708004829651?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1ZXNodXRvbmcxMjM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<h3 id="2-依赖冲突"><a href="#2-依赖冲突" class="headerlink" title="2.依赖冲突"></a>2.依赖冲突</h3><p>在实际项目中，我们基本都需要其他spring data 依赖，这时候启动elasticsearch就会报错，比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;&#x2F;artifactId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-data-neo4j&lt;&#x2F;artifactId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;&#x2F;artifactId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<p>再次启动程序，报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Caused by: java.lang.NoSuchFieldError: LUCENE_5_3_1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    at org.elasticsearch.Version.&lt;clinit&gt;(Version.java:279) ~[elasticsearch-2.4.6.jar:2.4.6]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    at org.elasticsearch.client.transport.TransportClient$Builder.build(TransportClient.java:131) ~[elasticsearch-2.4.6.jar:2.4.6]</span><br></pre></td></tr></table></figure>

<p>我们单独启动时正确，添加其它依赖后报错，错误肯定是依赖的原因了。</p>
<p>我们点击挑战到<code>Version.java:279</code>查看他的源代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static final Version V_2_1_0 &#x3D; new Version(V_2_1_0_ID, false, org.apache.lucene.util.Version.LUCENE_5_3_1);</span><br></pre></td></tr></table></figure>

<p>也就是说elasticsearch-2.1.0适配LUCENE-5.3.1，而我们的elasticsearch是2.4.6，继续查看源代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static final Version V_2_4_6 &#x3D; new Version(V_2_4_6_ID, false, org.apache.lucene.util.Version.LUCENE_5_5_4);</span><br></pre></td></tr></table></figure>

<p>所以我们需要LUCENE-5.5.4版本的依赖。</p>
<p>解决方法就是在pom.xml中导入依赖即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;org.apache.lucene&lt;&#x2F;groupId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;artifactId&gt;lucene-core&lt;&#x2F;artifactId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;version&gt;5.5.4&lt;&#x2F;version&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-入门"><a href="#2-入门" class="headerlink" title="2.入门"></a>2.入门</h3><blockquote>
<p>A default implementation of ElasticsearchRepository, aligning to the generic Repository Interfaces, is provided. Spring can do the Repository implementation for you depending on method names in the interface definition.（提供了一个与通用存储库接口一致的ElasticsearchRepository的默认实现。Spring可以根据接口定义中的方法名为您实现存储库。 ）</p>
<p>— 来自官方github</p>
</blockquote>
<p>实现Elasticsearch的增删改查就像我们使用Spring data jpa一样简单快捷。</p>
<p><strong>第一步，我们先创建一个实体类用于测试。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@Document(indexName &#x3D; &quot;library&quot;,type &#x3D; &quot;book&quot;)  &#x2F;&#x2F;indexName索引名称，type类别</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class Book &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private int id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private String anthony;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ....</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>第二步，新建新建ElasticsearchRepository接口。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Repository</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public interface BookRepository extends ElasticsearchRepository&lt;Book,Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Book findAllByName(String name);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>第三步，测试。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">@RunWith(SpringRunner.class)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@SpringBootTest</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class RobotsApplicationTests &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    BookRepository bookRepository;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public void contextLoads() &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Book book &#x3D; new Book(&quot;《西游记后传》&quot;,&quot;小白龙&quot;,1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        bookRepository.index(book); &#x2F;&#x2F;保存</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Book name &#x3D; bookRepository.findAllByName(&quot;西游记&quot;); &#x2F;&#x2F;查找</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        System.out.println(name);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看打印：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Book&#123;id&#x3D;1, name&#x3D;&#39;《西游记后传》&#39;, anthony&#x3D;&#39;小白龙&#39;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第五章：JEST"><a href="#第五章：JEST" class="headerlink" title="第五章：JEST"></a>第五章：JEST</h2><p>JEST默认不生效，需要我们导入依赖，JEST使用9200端口通过HTTP访问ES。</p>
<h3 id="1-导入依赖"><a href="#1-导入依赖" class="headerlink" title="1.导入依赖"></a>1.导入依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- JEST方式 --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;io.searchbox&lt;&#x2F;groupId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;artifactId&gt;jest&lt;&#x2F;artifactId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;version&gt;1.0.3&lt;&#x2F;version&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;com.sun.jna&lt;&#x2F;groupId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;artifactId&gt;jna&lt;&#x2F;artifactId&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;version&gt;3.0.9&lt;&#x2F;version&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-配置"><a href="#2-配置" class="headerlink" title="2.配置"></a>2.配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  elasticsearch:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    jest:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      uris: http:&#x2F;&#x2F;123.206.46.157:9200</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      username: elastic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      password: changeme</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      read-timeout: 5000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      connection-timeout: 5000</span><br></pre></td></tr></table></figure>

<h3 id="3-实体类"><a href="#3-实体类" class="headerlink" title="3.实体类"></a>3.实体类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class Book &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private int id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private String anthony;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    .....</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-保存"><a href="#4-保存" class="headerlink" title="4.保存"></a>4.保存</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">private JestClient jestClient;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public void contextLoads() &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Book book &#x3D; new Book(&quot;《西游记后传》&quot;,&quot;小白龙&quot;,120);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;构建一个索引功能 参数为路径...&#x2F;library&#x2F;old&#x2F;1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Index index &#x3D; new Index.Builder(book).index(&quot;library&quot;).type(&quot;old&quot;).id(&quot;3&quot;).build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;执行保存</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        jestClient.execute(index);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        e.printStackTrace();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-查询"><a href="#5-查询" class="headerlink" title="5.查询"></a>5.查询</h3><p>此处的query语句参考前面讲过的各种搜索方式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">String query &#x3D; &quot;&#123;&quot; +</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;    \&quot;query\&quot; : &#123;&quot; +</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;        \&quot;match\&quot; : &#123;&quot; +</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;            \&quot;name\&quot; : \&quot;西游\&quot;&quot; +</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;        &#125;&quot; +</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;    &#125;&quot; +</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &quot;&#125;&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Search search &#x3D; new Search.Builder(query).addIndex(&quot;library&quot;).addType(&quot;old&quot;).build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    SearchResult result &#x3D; jestClient.execute(search);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    System.out.println(result.getJsonString());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125; catch (IOException e) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    e.printStackTrace();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>个人觉得：JEST查询的不同与优势是可以获取全部的返回信息。</p>
<h2 id="第六章：Repository"><a href="#第六章：Repository" class="headerlink" title="第六章：Repository"></a>第六章：Repository</h2><h3 id="1-查询"><a href="#1-查询" class="headerlink" title="1.查询"></a>1.查询</h3><p>在ElasticsearchRepository中我们可以使用<code>Not</code> <code>Add</code> <code>Like</code> <code>Or</code> <code>Between</code>等关键词自动创建查询语句。</p>
<p>如官方示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">public interface BookRepository extends Repository&lt;Book, String&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     List&lt;Book&gt; findByNameAndPrice(String name, Integer price);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     List&lt;Book&gt; findByNameOrPrice(String name, Integer price);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     Page&lt;Book&gt; findByName(String name,Pageable page);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     Page&lt;Book&gt; findByNameNot(String name,Pageable page);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     Page&lt;Book&gt; findByPriceBetween(int price,Pageable page);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     Page&lt;Book&gt; findByNameLike(String name,Pageable page);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     @Query(&quot;&#123;\&quot;bool\&quot; : &#123;\&quot;must\&quot; : &#123;\&quot;term\&quot; : &#123;\&quot;message\&quot; : \&quot;?0\&quot;&#125;&#125;&#125;&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     Page&lt;Book&gt; findByMessage(String message, Pageable pageable);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h4 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h4><table>
<thead>
<tr>
<th align="left">关键字</th>
<th align="left">使用示例</th>
<th align="left">等同于的ES查询</th>
</tr>
</thead>
<tbody><tr>
<td align="left">And</td>
<td align="left">findByNameAndPrice</td>
<td align="left">{“bool” : {“must” : [ {“field” : {“name” : “?”}}, {“field” : {“price” : “?”}} ]}}</td>
</tr>
<tr>
<td align="left">Or</td>
<td align="left">findByNameOrPrice</td>
<td align="left">{“bool” : {“should” : [ {“field” : {“name” : “?”}}, {“field” : {“price” : “?”}} ]}}</td>
</tr>
<tr>
<td align="left">Is</td>
<td align="left">findByName</td>
<td align="left">{“bool” : {“must” : {“field” : {“name” : “?”}}}}</td>
</tr>
<tr>
<td align="left">Not</td>
<td align="left">findByNameNot</td>
<td align="left">{“bool” : {“must_not” : {“field” : {“name” : “?”}}}}</td>
</tr>
<tr>
<td align="left">Between</td>
<td align="left">findByPriceBetween</td>
<td align="left">{“bool” : {“must” : {“range” : {“price” : {“from” : ?,”to” : ?,”include_lower” : true,”include_upper” : true}}}}}</td>
</tr>
<tr>
<td align="left">LessThanEqual</td>
<td align="left">findByPriceLessThan</td>
<td align="left">{“bool” : {“must” : {“range” : {“price” : {“from” : null,”to” : ?,”include_lower” : true,”include_upper” : true}}}}}</td>
</tr>
<tr>
<td align="left">GreaterThanEqual</td>
<td align="left">findByPriceGreaterThan</td>
<td align="left">{“bool” : {“must” : {“range” : {“price” : {“from” : ?,”to” : null,”include_lower” : true,”include_upper” : true}}}}}</td>
</tr>
<tr>
<td align="left">Before</td>
<td align="left">findByPriceBefore</td>
<td align="left">{“bool” : {“must” : {“range” : {“price” : {“from” : null,”to” : ?,”include_lower” : true,”include_upper” : true}}}}}</td>
</tr>
<tr>
<td align="left">After</td>
<td align="left">findByPriceAfter</td>
<td align="left">{“bool” : {“must” : {“range” : {“price” : {“from” : ?,”to” : null,”include_lower” : true,”include_upper” : true}}}}}</td>
</tr>
<tr>
<td align="left">Like</td>
<td align="left">findByNameLike</td>
<td align="left">{“bool” : {“must” : {“field” : {“name” : {“query” : “? *”,”analyze_wildcard” : true}}}}}</td>
</tr>
<tr>
<td align="left">StartingWith</td>
<td align="left">findByNameStartingWith</td>
<td align="left">{“bool” : {“must” : {“field” : {“name” : {“query” : “? *”,”analyze_wildcard” : true}}}}}</td>
</tr>
<tr>
<td align="left">EndingWith</td>
<td align="left">findByNameEndingWith</td>
<td align="left">{“bool” : {“must” : {“field” : {“name” : {“query” : “*?”,”analyze_wildcard” : true}}}}}</td>
</tr>
<tr>
<td align="left">Contains/Containing</td>
<td align="left">findByNameContaining</td>
<td align="left">{“bool” : {“must” : {“field” : {“name” : {“query” : “?”,”analyze_wildcard” : true}}}}}</td>
</tr>
<tr>
<td align="left">In</td>
<td align="left">findByNameIn(Collectionnames)</td>
<td align="left">{“bool” : {“must” : {“bool” : {“should” : [ {“field” : {“name” : “?”}}, {“field” : {“name” : “?”}} ]}}}}</td>
</tr>
<tr>
<td align="left">NotIn</td>
<td align="left">findByNameNotIn(Collectionnames)</td>
<td align="left">{“bool” : {“must_not” : {“bool” : {“should” : {“field” : {“name” : “?”}}}}}}</td>
</tr>
<tr>
<td align="left">True</td>
<td align="left">findByAvailableTrue</td>
<td align="left">{“bool” : {“must” : {“field” : {“available” : true}}}}</td>
</tr>
<tr>
<td align="left">False</td>
<td align="left">findByAvailableFalse</td>
<td align="left">{“bool” : {“must” : {“field” : {“available” : false}}}}</td>
</tr>
<tr>
<td align="left">OrderBy</td>
<td align="left">findByAvailableTrueOrderByNameDesc</td>
<td align="left">{“sort” : [{ “name” : {“order” : “desc”} }],”bool” : {“must” : {“field” : {“available” : true}}}}</td>
</tr>
</tbody></table>
<h3 id="2-保存"><a href="#2-保存" class="headerlink" title="2.保存"></a>2.保存</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">private SampleElasticsearchRepository repository;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">String documentId &#x3D; &quot;123456&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SampleEntity sampleEntity1 &#x3D; new SampleEntity();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sampleEntity1.setId(documentId);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sampleEntity1.setMessage(&quot;some message&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">String documentId2 &#x3D; &quot;123457&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SampleEntity sampleEntity2 &#x3D; new SampleEntity();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sampleEntity2.setId(documentId2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sampleEntity2.setMessage(&quot;test message&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">List&lt;SampleEntity&gt; sampleEntities &#x3D; Arrays.asList(sampleEntity1, sampleEntity2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;bulk index</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">repository.save(sampleEntities);</span><br></pre></td></tr></table></figure>

<h3 id="3-更新"><a href="#3-更新" class="headerlink" title="3.更新"></a>3.更新</h3><p>要做到这一点，只需使用相同的ID保存该对象性即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Book name &#x3D; bookRepository.findAllById(100);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name.setAnthony(&quot;吴承恩&quot;); &#x2F;&#x2F;改变</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bookRepository.save(name); &#x2F;&#x2F;保存，此时ID不变</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name &#x3D; bookRepository.findAllById(100); &#x2F;&#x2F;再次查找</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">System.out.println(name);</span><br></pre></td></tr></table></figure>

<h3 id="4-删除"><a href="#4-删除" class="headerlink" title="4.删除"></a>4.删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bookRepository.delete(1);</span><br></pre></td></tr></table></figure>

<p>到此，Repository实现增删改查完成！</p>
<h2 id="第七章：模板"><a href="#第七章：模板" class="headerlink" title="第七章：模板"></a>第七章：模板</h2><p>上面我们使用了Spring data Jpa去实现增删改查等操作，下面的方式是通过ElasticsearchTemplate模板结合Query实现保存与查找。</p>
<h3 id="1-增加"><a href="#1-增加" class="headerlink" title="1.增加"></a>1.增加</h3><p>IndexQuery的作用是保存对象到elasticsearch。用法如下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">private ElasticsearchTemplate elasticsearchTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Book book &#x3D; new Book(&quot;《西游记后传》&quot;, &quot;小白龙&quot;, 100);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">IndexQuery indexQuery &#x3D; new IndexQueryBuilder()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .withIndexName(&quot;library&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .withType(&quot;book&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .withId(book.getId()+&quot;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .withObject(book) &#x2F;&#x2F;对象或集合</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elasticsearchTemplate.index(indexQuery);</span><br></pre></td></tr></table></figure>

<h3 id="2-删除"><a href="#2-删除" class="headerlink" title="2.删除"></a>2.删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;第一种删除具体的一条记录</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elasticsearchTemplate.delete(&quot;library&quot;,&quot;book&quot;,100+&quot;&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;第二种删除indexName&#x2F;type&#x2F;下的所有</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DeleteQuery deleteQuery &#x3D; new DeleteQuery();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">deleteQuery.setIndex(&quot;library&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">deleteQuery.setType(&quot;book&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elasticsearchTemplate.delete(deleteQuery);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;第三种删除indexName&#x2F;下的所有</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elasticsearchTemplate.deleteIndex(&quot;library&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;第四种删除查询出来的所有</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">deleteQuery &#x3D; new DeleteQuery();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">deleteQuery.setQuery(QueryBuilders.matchQuery(&quot;id&quot;,&quot;100&quot;));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elasticsearchTemplate.delete(deleteQuery);</span><br></pre></td></tr></table></figure>

<h3 id="3-更新-1"><a href="#3-更新-1" class="headerlink" title="3.更新"></a>3.更新</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Book book &#x3D; new Book(&quot;《西游记后传》&quot;, &quot;猪八戒&quot;, 100);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UpdateQuery updateQuery &#x3D; new UpdateQueryBuilder()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .withIndexName(&quot;library&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .withType(&quot;book&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .withId(book.getId()+&quot;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elasticsearchTemplate.update(updateQuery);</span><br></pre></td></tr></table></figure>

<h3 id="4-查询"><a href="#4-查询" class="headerlink" title="4.查询"></a>4.查询</h3><p>查询不同于前面几个，查询比较复杂，比如模糊查询，组合查询，准确查询等。这些变化来源于不同的<code>QueryBuilder</code>，查询的模板是相同的。如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">private ElasticsearchTemplate elasticsearchTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Sort sort &#x3D; new Sort(Sort.Direction.DESC, &quot;id&quot;);&#x2F;&#x2F;以id值为准 降序排列，ASC为升序</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Pageable pageable &#x3D; new PageRequest(0, 10, sort);&#x2F;&#x2F;查看第0页，以每页10条划分</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SearchQuery searchQuery &#x3D; new NativeSearchQueryBuilder()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .withQuery(QueryBuilders.matchAllQuery()) &#x2F;&#x2F; 自定义查询（这是不同的地方）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .withPageable(pageable) &#x2F;&#x2F; 自定义分页</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Page&lt;Book&gt; sampleEntities &#x3D; elasticsearchTemplate.queryForPage(searchQuery,Book.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">System.out.println(&quot;页数&quot; + sampleEntities.getTotalPages());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">System.out.println(&quot;行数&quot; + sampleEntities.getTotalElements());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">System.out.println(&quot;大小&quot; + sampleEntities.getSize());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">System.out.println(&quot;当前第几页&quot; + sampleEntities.getNumber());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">System.out.println(&quot;当前页的数量&quot;+sampleEntities.getNumberOfElements());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">System.out.println(&quot;List&lt;Book&gt;:&quot;+sampleEntities.getContent());</span><br></pre></td></tr></table></figure>

<p>其它条件查询下面讲解！</p>
<h2 id="第八章：术语"><a href="#第八章：术语" class="headerlink" title="第八章：术语"></a>第八章：术语</h2><p>为什么要在插一节术语？是因为官方注释比较晦涩，为了方便下面的阅读，可以先了解下，如果已了解请跳过。</p>
<h3 id="Analysis（分析）"><a href="#Analysis（分析）" class="headerlink" title="Analysis（分析）"></a>Analysis（分析）</h3><p> 分析的过程就是将全文（full text）转换成 术语／分词（terms）。 这取决于使用那个分析器,这些短语:“FOO BAR”, “Foo-Bar”, “foo,bar”，可能会拆分成” foo”和“bar”。这些拆分后的词实际上是存储在索引中。一个完整的文本查询(而不是一个分词查询) “FoO:bAR”，将被分解成 “foo”,“bar”,来匹配存储在索引中的分词。正是这一过程的分析(包括在索引时间和搜索时间),允许elasticsearch执行全文查询。</p>
<h3 id="Cluster-（集群）"><a href="#Cluster-（集群）" class="headerlink" title="Cluster （集群）"></a>Cluster （集群）</h3><p> 一个集群包含一个或多个分配了相同的集群名称的节点。每个集群都有一个主节点是集群自动选择产生,并且可以决定如果当前主节点失败，哪些可以替换。</p>
<h3 id="Document（文档）"><a href="#Document（文档）" class="headerlink" title="Document（文档）"></a>Document（文档）</h3><p> 文档是存储在elasticsearch中的一个JSON文件。这是相当与关系数据库中表的一行数据。每个文档被存储在索引中，并具有一个类型和一个id。一个文档是一个JSON对象（也被称为在其他语言中的 hash / hashmap / associative array（关联数组）），其中包含零个或多个字段 或者 键值对。原始JSON文档将被存储在索引的_source字段，在获得（getting）或者 搜索（searching）默认的返回时，得到或搜索文档。</p>
<h3 id="Id（标识）"><a href="#Id（标识）" class="headerlink" title="Id（标识）"></a>Id（标识）</h3><p> 每个文档ID标识了一个文档。一个文档的索引/类型/ ID必须是唯一的。如果没有提供ID，将是自动生成。（还可以看到路由）</p>
<h3 id="Field（字段）"><a href="#Field（字段）" class="headerlink" title="Field（字段）"></a>Field（字段）</h3><p> 文档中包含的一组字段或键值对。字段的值可以是一个简单的（标量）值（如字符串，整数，日期），或者一个嵌套的结构就像一个数组或对象。一个字段就是类似关系数据库表中的一列。映射的每个字段有一个字段的类型“type”（不要与文档类型混淆），表示那种类型的数据可以存储在该字段里，如：整数，字符串，对象。映射还允许你定义（除其他事项外）一个字段的值如何进行分析。</p>
<h3 id="Index（索引）"><a href="#Index（索引）" class="headerlink" title="Index（索引）"></a>Index（索引）</h3><p> 索引就是像关系数据库中的“数据库”。通过映射可以定义成多种类型。索引是一个逻辑命名空间映射到一个或多个主要的分片，可以有零个或多个副本分片。</p>
<h3 id="Mapping（映射）"><a href="#Mapping（映射）" class="headerlink" title="Mapping（映射）"></a>Mapping（映射）</h3><p> 映射是像关系数据库中的”模式定义“。每个索引都有一个映射，它定义了每个索引的类型，再加上一些索引范围的设置。映射可以被明确地定义，或者在一个文档被索引的时候自动生成。</p>
<h3 id="Node（节点）"><a href="#Node（节点）" class="headerlink" title="Node（节点）"></a>Node（节点）</h3><p> 节点是属于elasticsearch群集的运行实例。测试的时候，在一台服务器可以启动多个节点，但通常情况下应该在一台服务器运行一个节点。在启动时，节点将使用单播（或组播，但是必须指定）来发现使用相同的群集名称的群集，并会尝试加入该群集。</p>
<h3 id="Primary-shard（主分片）"><a href="#Primary-shard（主分片）" class="headerlink" title="Primary shard（主分片）"></a>Primary shard（主分片）</h3><p> 每个文档都存储在一个主要分片上。当你索引一个文档时，索引首先生成在主分片上，然后才到主分片的所有副本上。默认情况下，索引有5个主分片。您可以指定更多或更少的主分片来适应索引可以处理的文档数。一旦创建了索引，就不能改变索引中主分片的数量。</p>
<h3 id="Replica-shard（副本分片）"><a href="#Replica-shard（副本分片）" class="headerlink" title="Replica shard（副本分片）"></a>Replica shard（副本分片）</h3><p> 每个主分片可以有零个或多个副本。副本是主分片的一个拷贝，有两个作用：</p>
<p> 1、故障转移：如果主分片有问题，副本分片可以提升为主分片；</p>
<p> 2、提高性能：获取和搜索请求可以处理主分片或副本分片。</p>
<p> 默认情况下，每个主分片有一个副本，不过索引的副本数量可以动态地改变。在同一个节点上，一个副本分片将永远不会和其主分片一起运行。</p>
<h3 id="Routing（路由）"><a href="#Routing（路由）" class="headerlink" title="Routing（路由）"></a>Routing（路由）</h3><p> 当你索引一个文档，它是存储在一个主分片里。这分片的选择是通过哈希的路由值。默认情况下，路由值来自文档的ID；如果该文档指定了父文档，则使用父文档的ID（以确保这个子文档和父文件都存储在相同的分片上）。这个路由值可以在索引的时候，通过指定数值或者配置字段映射来覆盖。</p>
<h3 id="Shard（分片）"><a href="#Shard（分片）" class="headerlink" title="Shard（分片）"></a>Shard（分片）</h3><p> 一个分片是一个单一的Lucene的实例。这是一个低级别的通过ElasticSearch自动管理的“工作者”单元。索引是一个逻辑命名空间指向主分片和副本分片。索引的主分片和副本分片的数量需要明确的指定。然而你的代码应该只处理一个索引。Elasticsearch分配集群中所有节点的分片。在节点出现故障或增加新节点的时候，可以自动的将一个节点上的分片移动到另一个节点上。</p>
<h3 id="Source-field（源字段）"><a href="#Source-field（源字段）" class="headerlink" title="Source field（源字段）"></a>Source field（源字段）</h3><p> 默认情况下，你的JSON文档将被索引存储在_source字段里面，所有的get（获取）和search（搜索）请求将返回的该字段。这将允许你直接从搜索结果中访问到源数据，而不需要再次发起请求检索。</p>
<p> 注：索引将返回完整的的JSON字符串给你，即使它包含无效的JSON。此字段里的内容不表示任何该对象里面的数据如何被索引。</p>
<h3 id="Term（术语）"><a href="#Term（术语）" class="headerlink" title="Term（术语）"></a>Term（术语）</h3><p> 在elasticsearch里，术语(term)是一个被索引的精确值。术语 foo, Foo,FOO 是不想等的。术语（即精确值）可以使用“term”查询接口来查询。</p>
<h3 id="Text-文本"><a href="#Text-文本" class="headerlink" title="Text(文本)"></a>Text(文本)</h3><p> 文本（或全文）是普通非结构化的文本，如本段。默认情况下，文本将被分析成术语，术语才是实际存储在索引中。文本字段在索引时需要进行分析，以便全文搜索，全文查询的关键字在搜索时，必须分析产生（搜索）与索引时相同的术语。</p>
<h3 id="Type-类型"><a href="#Type-类型" class="headerlink" title="Type(类型)"></a>Type(类型)</h3><p> Type是相当于关系数据库中的“表”。每种类型都有一列字段，用来定义文档的类型。映射定义了对在文档中的每个字段如何进行分析。</p>
<h2 id="第九章：构建查询"><a href="#第九章：构建查询" class="headerlink" title="第九章：构建查询"></a>第九章：构建查询</h2><p>上面只是模糊的讲了查询模板，现在来仔细说说查询！</p>
<p>首先你要明白QueryBuilder系列（MatchAllQueryBuilder.class，FuzzyQueryBuilder.class等）是什么？</p>
<p>它们是具体的查询实现类，它们是QueryBuilders抽象类的子类并实现了BoostableQueryBuilder&lt;&gt;接口。</p>
<p>而QueryBuilders的主要作用就是提供了静态方法去创建一个子类的对象，方便QueryBuilder的构建与管理。</p>
<p>我们从源码的角度去分析它的一些方法！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line">匹配所有文档的查询。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matchAllQuery()</span><br><span class="line">为提供的字段名和文本创建类型为“BOOLEAN”的匹配查询。(解释过来就是单个匹配，可以模糊匹配)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matchQuery(String name, Object text) &#x2F;&#x2F;name 字段值 ，text 查询文本（不支持通配符）</span><br><span class="line">为提供的字段名和文本创建一个通用查询。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">commonTermsQuery(String name, Object text)</span><br><span class="line">为提供的字段名和文本创建类型为“BOOLEAN”的匹配查询。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">multiMatchQuery(Object text, String... fieldNames) </span><br><span class="line">为提供的字段名和文本创建一个文本查询，并输入“短句”。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matchPhraseQuery(String name, Object text)</span><br><span class="line">为提供的字段名和文本创建一个与类型“PHRASE_PREFIX”匹配的查询。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matchPhrasePrefixQuery(String name, Object text)</span><br><span class="line">匹配包含术语的文档的查询。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">termQuery(String name, Object value)</span><br><span class="line">使用模糊查询匹配文档的查询</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fuzzyQuery(String name, Object value)</span><br><span class="line">与包含指定前缀的术语的文档相匹配的查询。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">prefixQuery(String name, String prefix)</span><br><span class="line">在一定范围内匹配文档的查询。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rangeQuery(String name)</span><br><span class="line">实现通配符搜索查询。支持的通配符是*，它匹配任何字符序列(包括空字符)，而?它匹配任何单个字符。注意，这个查询可能很慢，因为它需要遍历许多项。为了防止异常缓慢的通配符查询，通配符项不应该以一个通配符*或?开头。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">wildcardQuery(String name, String query) &#x2F;&#x2F;query 通配符查询字符串</span><br><span class="line">将包含术语的文档与指定的正则表达式匹配的查询</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">regexpQuery(String name, String regexp) &#x2F;&#x2F;regexp的正则表达式</span><br><span class="line">解析查询字符串并运行它的查询。有两种模式。第一,当没有字段添加(使用QueryStringQueryBuilder.field(字符串),将运行查询一次,非前缀字段将使用QueryStringQueryBuilder.defaultField(字符串)。第二,当一个或多个字段添加(使用QueryStringQueryBuilder.field(String)),将运行提供的解析查询字段,并结合使用DisMax或普通的布尔查询(参见QueryStringQueryBuilder.useDisMax(布尔))。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">queryStringQuery(String queryString)</span><br><span class="line">类似于query_string查询的查询，但不会为任何奇怪的字符串语法抛出异常。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">simpleQueryStringQuery(String queryString)</span><br><span class="line">可以使用BoostingQuery类来有效地降级与给定查询匹配的结果。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">boostingQuery()</span><br><span class="line">匹配与其他查询的布尔组合匹配的文档的查询</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">boolQuery()</span><br><span class="line">创建一个可用于实现MultiTermQueryBuilder的子查询的SpanQueryBuilder。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">spanMultiTermQueryBuilder(MultiTermQueryBuilder multiTermQueryBuilder)</span><br><span class="line">允许定义自定义得分函数的查询。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">functionScoreQuery(QueryBuilder queryBuilder, ScoreFunctionBuilder function)</span><br><span class="line">更像这样的查询，查找“like”提供的文档，例如提供的MoreLikeThisQueryBuilder.likeText(String)，它是针对查询所构造的字段进行检查的</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">moreLikeThisQuery(String... fields)</span><br><span class="line">构造一个新的非计分子查询，包含子类型和要在子文档上运行的查询。这个查询的结果是这些子文档匹配的父文档。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hasChildQuery(String type, QueryBuilder query)</span><br><span class="line">构造一个新的非评分父查询，父类型和在父文档上运行的查询。这个查询的结果是父文档匹配的子文档。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hasParentQuery(String type, QueryBuilder query)</span><br><span class="line">基于对其中任何一个项进行匹配的若干项的字段文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">termsQuery(String name, String... values)</span><br><span class="line">一个查询构建器，它允许构建给定JSON字符串或二进制数据作为输入的查询。当您希望使用Java Builder API，但仍然需要将JSON查询字符串与其他查询构建器结合时，这是非常有用的。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">wrapperQuery(String source)</span><br></pre></td></tr></table></figure>

<p>这些都是官方提供的注释，有些晦涩难懂，还有很多，我这里不一一列举。</p>
<p>只需要明确一点，我们使用上述静态方法只是为了方便创建QueryBuilder系列对象。</p>
<h2 id="第十章：条件查询"><a href="#第十章：条件查询" class="headerlink" title="第十章：条件查询"></a>第十章：条件查询</h2><p>我们调用QueryBuilders 的静态方法创建完具体的QueryBuilder对象之后，传入<code>.withQuery(QueryBuilder)</code>方法就可以实现的自定义查询。</p>
<h3 id="1-完全匹配"><a href="#1-完全匹配" class="headerlink" title="1.完全匹配"></a>1.完全匹配</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MatchQueryBuilder queryBuilder &#x3D; QueryBuilders.matchQuery(&quot;字段名&quot;, &quot;查询文本&quot;);</span><br></pre></td></tr></table></figure>

<h3 id="2-短语匹配"><a href="#2-短语匹配" class="headerlink" title="2.短语匹配"></a>2.短语匹配</h3><p>比如你要查询短语<code>Love You</code>，当你使用<code>QueryBuilders.matchQuery(&quot;name&quot;, &quot;Love You&quot;)</code>时，可能会查询到<code>Love And You</code>这样分开的结果，这时候我们指定为短语进行查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilder queryBuilder &#x3D; QueryBuilders.matchPhraseQuery(&quot;name&quot;, &quot;Love You&quot;);</span><br></pre></td></tr></table></figure>

<h3 id="3-模糊匹配"><a href="#3-模糊匹配" class="headerlink" title="3.模糊匹配"></a>3.模糊匹配</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MoreLikeThisQueryBuilder queryBuilder &#x3D; QueryBuilders</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .moreLikeThisQuery(&quot;name&quot;)&#x2F;&#x2F; 要匹配的字段, 不填默认_all</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .like(&quot;西游&quot;)&#x2F;&#x2F; 匹配的文本</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .minTermFreq(1);&#x2F;&#x2F; 文本最少出现的次数（默认是2，我们设为1）</span><br></pre></td></tr></table></figure>

<p>我们再从源码去看其它方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">添加一些文本以查找“类似”的文档</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">addLikeText(String... likeTexts)</span><br><span class="line">查找类似文档</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">like(Item... likeItems)</span><br><span class="line">设置不从其中选择（比如我们调用.like(&quot;西游&quot;).unlike(&quot;西游记&quot;)这样会导致啥也查不到）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">unlike(String... unlikeTexts)</span><br><span class="line">添加一些文本以查找与此不同的文档</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">addUnlikeText(String... unlikeTexts)</span><br><span class="line">设置将包含在任何生成查询中的查询条件的最大数量。默认25</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">maxQueryTerms(int maxQueryTerms)</span><br><span class="line">设置单词被忽略的频率，默认5，小于将不会被发现</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">minDocFreq(int minDocFreq)</span><br><span class="line">设置单词仍然出现的最大频率。单词出现更多的文档将被忽略。默认为无限</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">maxDocFreq(int maxDocFreq)</span><br><span class="line">设置将被忽略的单词的最小单词长度，默认0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">minWordLength(int minWordLength)</span><br><span class="line">设置将被忽略的单词的最大单词长度，默认无限</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">maxWordLength(int maxWordLength)</span><br><span class="line">设置停止词，匹配时会忽略停止词</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stopWords(String... stopWords)</span><br><span class="line">设置词语权重，默认是1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">boostTerms(float boostTerms)</span><br><span class="line">查询权重（默认1）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">boost(float boost)</span><br><span class="line">设置不从其中选择术语的文本（文档Item）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ignoreLike(String... likeText)</span><br></pre></td></tr></table></figure>

<h3 id="4-组合查询"><a href="#4-组合查询" class="headerlink" title="4.组合查询"></a>4.组合查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilder queryBuilder &#x3D; QueryBuilders.boolQuery()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .must(QueryBuilders.matchQuery(&quot;name&quot;, &quot;西游&quot;)) &#x2F;&#x2F;AND</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .must(QueryBuilders.wildcardQuery(&quot;name&quot;, &quot;西游?&quot;)) &#x2F;&#x2F;Not</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .should(QueryBuilders.matchQuery(&quot;name&quot;, &quot;西游记&quot;)); &#x2F;&#x2F;Or</span><br></pre></td></tr></table></figure>

<h3 id="5-包裹查询"><a href="#5-包裹查询" class="headerlink" title="5.包裹查询"></a>5.包裹查询</h3><p>高于设定分数, 不计算相关性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilder queryBuilder &#x3D; QueryBuilders</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .constantScoreQuery(QueryBuilders.matchQuery(&quot;name&quot;, &quot;西游记&quot;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .boost(2.0f);</span><br></pre></td></tr></table></figure>

<h3 id="6-范围查询"><a href="#6-范围查询" class="headerlink" title="6.范围查询"></a>6.范围查询</h3><p>查询id值在20-50之间的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilder queryBuilder &#x3D; QueryBuilders.rangeQuery(&quot;id&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .from(&quot;20&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .to(&quot;50&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .includeLower(true)     &#x2F;&#x2F; 包含上界</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        .includeUpper(true);      &#x2F;&#x2F; 包含下届</span><br></pre></td></tr></table></figure>

<h3 id="7-通配符查询"><a href="#7-通配符查询" class="headerlink" title="7.通配符查询"></a>7.通配符查询</h3><p>通配符查询, 支持 * 匹配任何字符序列, 包括空</p>
<p>避免* 开始, 会检索大量内容造成效率缓慢</p>
<p>单个字符用?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilder queryBuilder &#x3D; QueryBuilders.wildcardQuery(&quot;user&quot;, &quot;ki*hy&quot;);</span><br></pre></td></tr></table></figure>

<h3 id="8-过滤查询"><a href="#8-过滤查询" class="headerlink" title="8.过滤查询"></a>8.过滤查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QueryBuilders.constantScoreQuery(FilterBuilders.termQuery(&quot;name&quot;, &quot;kimchy&quot;)).boost(2.0f);</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Leng Leng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.520517.xyz/2021/03/25/d48132d3.html">https://www.520517.xyz/2021/03/25/d48132d3.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.520517.xyz" target="_blank">冷冷</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AD%A6%E4%B9%A0/">学习</a></div><div class="post_share"><div class="social-share" data-image="http://api.mtyqx.cn/api/random.php?44" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/03/26/e4195c09.html"><img class="prev-cover" data-lazy-src="http://api.mtyqx.cn/api/random.php?55" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">如何判断是微信或者支付宝？</div></div></a></div><div class="next-post pull-right"><a href="/2021/03/25/f40a9a4c.html"><img class="next-cover" data-lazy-src="http://api.mtyqx.cn/api/random.php?43" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ElasticSearch快速入门</div></div></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="https://cdn.jsdelivr.net/gh/myGitxb/picpigo/img/20201205124619.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Leng Leng</div><div class="author-info__description">不忘初心，方得始终</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">90</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/myGitxb"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:211711111@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=211711111" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">我是冷冷</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Elasticsearch%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97"><span class="toc-number">1.</span> <span class="toc-text">Elasticsearch使用指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ES%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">1.1.1.</span> <span class="toc-text">ES是什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2"><span class="toc-number">1.1.2.</span> <span class="toc-text">什么是全文检索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ES%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.1.3.</span> <span class="toc-text">ES的应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ES%E7%9A%84%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.4.</span> <span class="toc-text">ES的存储结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0%EF%BC%9A%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.</span> <span class="toc-text">第一章：安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%8B%E8%BD%BD"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%A7%A3%E5%8E%8B"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.解压</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.3.</span> <span class="toc-text">3.配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%90%AF%E5%8A%A8"><span class="toc-number">1.2.4.</span> <span class="toc-text">4.启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%9F%A5%E7%9C%8B%E5%86%85%E5%AD%98"><span class="toc-number">1.2.5.</span> <span class="toc-text">5.查看内存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96"><span class="toc-number">1.2.6.</span> <span class="toc-text">7.内存优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%AE%BF%E9%97%AE%E7%BD%91%E9%A1%B5"><span class="toc-number">1.2.7.</span> <span class="toc-text">6.访问网页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%8F%AF%E8%A7%86%E5%8C%96%E6%8F%92%E4%BB%B6"><span class="toc-number">1.2.8.</span> <span class="toc-text">7.可视化插件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.</span> <span class="toc-text">第二章：查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A4%9A%E7%B4%A2%E5%BC%95"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.多索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%9A%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.多类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-URI%E6%90%9C%E7%B4%A2"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.URI搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%AF%B7%E6%B1%82%E6%AD%A3%E6%96%87%E6%90%9C%E7%B4%A2"><span class="toc-number">1.3.4.</span> <span class="toc-text">4.请求正文搜索</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0%EF%BC%9A%E6%90%9C%E7%B4%A2"><span class="toc-number">1.4.</span> <span class="toc-text">第三章：搜索</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%9F%AD%E8%AF%AD%E5%8C%B9%E9%85%8D"><span class="toc-number">1.4.1.</span> <span class="toc-text">1.短语匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%8F%90%E9%AB%98%E7%B2%BE%E5%BA%A6"><span class="toc-number">1.4.2.</span> <span class="toc-text">2.提高精度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.组合查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%8F%90%E9%AB%98%E6%9D%83%E9%87%8D"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.提高权重</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%88%86%E9%A1%B5"><span class="toc-number">1.4.5.</span> <span class="toc-text">5.分页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%8C%87%E5%AE%9A%E8%BF%94%E5%9B%9E%E5%B1%9E%E6%80%A7"><span class="toc-number">1.4.6.</span> <span class="toc-text">6.指定返回属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E9%AB%98%E4%BA%AE%E6%90%9C%E7%B4%A2"><span class="toc-number">1.4.7.</span> <span class="toc-text">7.高亮搜索</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0%EF%BC%9ASpringBoot"><span class="toc-number">1.5.</span> <span class="toc-text">第四章：SpringBoot</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-SpringData"><span class="toc-number">1.5.1.</span> <span class="toc-text">1.SpringData</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BE%9D%E8%B5%96%E5%86%B2%E7%AA%81"><span class="toc-number">1.5.2.</span> <span class="toc-text">2.依赖冲突</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%A5%E9%97%A8"><span class="toc-number">1.5.3.</span> <span class="toc-text">2.入门</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0%EF%BC%9AJEST"><span class="toc-number">1.6.</span> <span class="toc-text">第五章：JEST</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-number">1.6.1.</span> <span class="toc-text">1.导入依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.6.2.</span> <span class="toc-text">2.配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-number">1.6.3.</span> <span class="toc-text">3.实体类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BF%9D%E5%AD%98"><span class="toc-number">1.6.4.</span> <span class="toc-text">4.保存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.5.</span> <span class="toc-text">5.查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0%EF%BC%9ARepository"><span class="toc-number">1.7.</span> <span class="toc-text">第六章：Repository</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.7.1.</span> <span class="toc-text">1.查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">关键字</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BF%9D%E5%AD%98"><span class="toc-number">1.7.2.</span> <span class="toc-text">2.保存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9B%B4%E6%96%B0"><span class="toc-number">1.7.3.</span> <span class="toc-text">3.更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%A0%E9%99%A4"><span class="toc-number">1.7.4.</span> <span class="toc-text">4.删除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E7%AB%A0%EF%BC%9A%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.8.</span> <span class="toc-text">第七章：模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A2%9E%E5%8A%A0"><span class="toc-number">1.8.1.</span> <span class="toc-text">1.增加</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%A0%E9%99%A4"><span class="toc-number">1.8.2.</span> <span class="toc-text">2.删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9B%B4%E6%96%B0-1"><span class="toc-number">1.8.3.</span> <span class="toc-text">3.更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.8.4.</span> <span class="toc-text">4.查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AB%E7%AB%A0%EF%BC%9A%E6%9C%AF%E8%AF%AD"><span class="toc-number">1.9.</span> <span class="toc-text">第八章：术语</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Analysis%EF%BC%88%E5%88%86%E6%9E%90%EF%BC%89"><span class="toc-number">1.9.1.</span> <span class="toc-text">Analysis（分析）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cluster-%EF%BC%88%E9%9B%86%E7%BE%A4%EF%BC%89"><span class="toc-number">1.9.2.</span> <span class="toc-text">Cluster （集群）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Document%EF%BC%88%E6%96%87%E6%A1%A3%EF%BC%89"><span class="toc-number">1.9.3.</span> <span class="toc-text">Document（文档）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Id%EF%BC%88%E6%A0%87%E8%AF%86%EF%BC%89"><span class="toc-number">1.9.4.</span> <span class="toc-text">Id（标识）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Field%EF%BC%88%E5%AD%97%E6%AE%B5%EF%BC%89"><span class="toc-number">1.9.5.</span> <span class="toc-text">Field（字段）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Index%EF%BC%88%E7%B4%A2%E5%BC%95%EF%BC%89"><span class="toc-number">1.9.6.</span> <span class="toc-text">Index（索引）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapping%EF%BC%88%E6%98%A0%E5%B0%84%EF%BC%89"><span class="toc-number">1.9.7.</span> <span class="toc-text">Mapping（映射）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node%EF%BC%88%E8%8A%82%E7%82%B9%EF%BC%89"><span class="toc-number">1.9.8.</span> <span class="toc-text">Node（节点）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Primary-shard%EF%BC%88%E4%B8%BB%E5%88%86%E7%89%87%EF%BC%89"><span class="toc-number">1.9.9.</span> <span class="toc-text">Primary shard（主分片）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Replica-shard%EF%BC%88%E5%89%AF%E6%9C%AC%E5%88%86%E7%89%87%EF%BC%89"><span class="toc-number">1.9.10.</span> <span class="toc-text">Replica shard（副本分片）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Routing%EF%BC%88%E8%B7%AF%E7%94%B1%EF%BC%89"><span class="toc-number">1.9.11.</span> <span class="toc-text">Routing（路由）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shard%EF%BC%88%E5%88%86%E7%89%87%EF%BC%89"><span class="toc-number">1.9.12.</span> <span class="toc-text">Shard（分片）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Source-field%EF%BC%88%E6%BA%90%E5%AD%97%E6%AE%B5%EF%BC%89"><span class="toc-number">1.9.13.</span> <span class="toc-text">Source field（源字段）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Term%EF%BC%88%E6%9C%AF%E8%AF%AD%EF%BC%89"><span class="toc-number">1.9.14.</span> <span class="toc-text">Term（术语）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Text-%E6%96%87%E6%9C%AC"><span class="toc-number">1.9.15.</span> <span class="toc-text">Text(文本)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Type-%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.9.16.</span> <span class="toc-text">Type(类型)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B9%9D%E7%AB%A0%EF%BC%9A%E6%9E%84%E5%BB%BA%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.10.</span> <span class="toc-text">第九章：构建查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E7%AB%A0%EF%BC%9A%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.11.</span> <span class="toc-text">第十章：条件查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%8C%E5%85%A8%E5%8C%B9%E9%85%8D"><span class="toc-number">1.11.1.</span> <span class="toc-text">1.完全匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%9F%AD%E8%AF%AD%E5%8C%B9%E9%85%8D"><span class="toc-number">1.11.2.</span> <span class="toc-text">2.短语匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%A8%A1%E7%B3%8A%E5%8C%B9%E9%85%8D"><span class="toc-number">1.11.3.</span> <span class="toc-text">3.模糊匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.11.4.</span> <span class="toc-text">4.组合查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%8C%85%E8%A3%B9%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.11.5.</span> <span class="toc-text">5.包裹查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.11.6.</span> <span class="toc-text">6.范围查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E9%80%9A%E9%85%8D%E7%AC%A6%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.11.7.</span> <span class="toc-text">7.通配符查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E8%BF%87%E6%BB%A4%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.11.8.</span> <span class="toc-text">8.过滤查询</span></a></li></ol></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/11/03/5976fbd0.html" title="Eureka使用"><img data-lazy-src="http://api.mtyqx.cn/api/random.php?90" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Eureka使用"/></a><div class="content"><a class="title" href="/2021/11/03/5976fbd0.html" title="Eureka使用">Eureka使用</a><time datetime="2021-11-03T08:48:37.000Z" title=" 2021-11-03 16:48:37">2021-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/02/dff1e781.html" title="joe博客使用"><img data-lazy-src="http://api.mtyqx.cn/api/random.php?" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="joe博客使用"/></a><div class="content"><a class="title" href="/2021/11/02/dff1e781.html" title="joe博客使用">joe博客使用</a><time datetime="2021-11-02T04:01:21.000Z" title=" 2021-11-02 12:01:21">2021-11-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/01/94b0d4da.html" title="宝塔面板使用"><img data-lazy-src="http://api.mtyqx.cn/api/random.php?88" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="宝塔面板使用"/></a><div class="content"><a class="title" href="/2021/11/01/94b0d4da.html" title="宝塔面板使用">宝塔面板使用</a><time datetime="2021-11-01T15:07:58.000Z" title=" 2021-11-01 23:07:58">2021-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/01/deba1672.html" title="对象内存图"><img data-lazy-src="http://api.mtyqx.cn/api/random.php?87" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="对象内存图"/></a><div class="content"><a class="title" href="/2021/11/01/deba1672.html" title="对象内存图">对象内存图</a><time datetime="2021-11-01T14:06:06.000Z" title=" 2021-11-01 22:06:06">2021-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/01/9a32718b.html" title="设计类和对象、定义类注意事项"><img data-lazy-src="http://api.mtyqx.cn/api/random.php?86" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="设计类和对象、定义类注意事项"/></a><div class="content"><a class="title" href="/2021/11/01/9a32718b.html" title="设计类和对象、定义类注意事项">设计类和对象、定义类注意事项</a><time datetime="2021-11-01T12:44:58.000Z" title=" 2021-11-01 20:44:58">2021-11-01</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Leng Leng</div><div class="framework-info"><span>框架 </span><a href="https://www.520517.xyz">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a href="https://www.520517.xyz/">Butterfly</a></div><div class="icp"><a><img class="icp-icon" src="/img/icp.png" alt="ICP"/><span>豫ICP备20011122号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/gh/my-zhb/CDN/blog/js/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/my-zhb/CDN/blog/js/utils.min.js"></script><script src="https://cdn.jsdelivr.net/gh/my-zhb/CDN/blog/js/main.min.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>window.ga_tid='UA-179333436-1';(function(){var dga=document.createElement("script");dga.src="https://rmt.dogedoge.com/fetch/public/ga.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(dga,s)})();</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2009371_z2n39cebnib.css"><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" async="async" mobile="false"></script></div></body></html>